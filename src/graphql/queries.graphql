query GetActiveUserOptions($user: String!) {
  UserOption(
    where: {owner: {address: {_eq: $user}}, fullyExercised: {_eq: false}}
    limit: 1000
  ) {
    id
    optionId
    owner {
      address
    }
    market {
      address
    }
    exerciseEvents {
      transactionHash
    }
    mintEvent {
      transactionHash
    }
    optionType
    strikeTick
    entryTick
    startTick
    strikePrice
    entryPrice
    expiresAt
    createdAt
    premium
    protocolFee
    realizedPayout
    liquiditiesAtOpen
    liquiditiesCurrent
    positionSizeAtOpen
    positionSizeCurrent
    fullyExercised
  }
}

query GetClosedUserOptions($user: String!) {
  UserOption(
    where: {owner: {address: {_eq: $user}}, fullyExercised: {_eq: true}}
    limit: 1000
  ) {
    id
    optionId
    owner {
      address
    }
    market {
      address
    }
    exerciseEvents {
      transactionHash
    }
    mintEvent {
      transactionHash
    }
    optionType
    strikeTick
    entryTick
    startTick
    strikePrice
    entryPrice
    expiresAt
    createdAt
    premium
    protocolFee
    realizedPayout
    liquiditiesAtOpen
    liquiditiesCurrent
    positionSizeAtOpen
    positionSizeCurrent
    fullyExercised
  }
}

query GetMarketData($marketAddr: String!) {
  TimelockMarket(where: {address: {_eq: $marketAddr}}, limit: 1) {
    id
    address
    optionsCount
    tradersCount
    vault
    pool
    tickSpacing
    optionAssetIsToken0
    optionAsset
    payoutAsset
    optionAssetDecimals
    payoutAssetDecimals
    optionAssetSymbol
    payoutAssetSymbol
    optionAssetName
    payoutAssetName
  }
}

query GetUserMarketOperators($userAddr: String!, $marketAddr: String!) {
  UserMarketOperator(
    where: {
      user: {address: {_eq: $userAddr}}
      market: {address: {_eq: $marketAddr}}
    }
    limit: 1000
  ) {
    id
    operator {
      address
    }
    canExtend
    canExercise
    canTransfer
    canMint
    spendingApproval
  }
}
